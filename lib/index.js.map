{
  "version": 3,
  "sources": [
    "index.js"
  ],
  "names": [
    "Private",
    "PDF2IMG",
    "options",
    "quality",
    "format",
    "size",
    "density",
    "savedir",
    "undefined",
    "savename",
    "identify",
    "file_path",
    "argument",
    "image",
    "resolve",
    "reject",
    "error",
    "data",
    "writeImage",
    "stream",
    "output",
    "filename",
    "page",
    "resize",
    "write",
    "name",
    "basename",
    "statSync",
    "path",
    "pdf_path",
    "isValidPDF",
    "fileExists",
    "extname",
    "get",
    "set",
    "sep",
    "mkdirsSync",
    "pages",
    "getPageCount",
    "message",
    "toImage",
    "result",
    "getPage",
    "Array",
    "isArray",
    "each",
    "push",
    "convert",
    "bind",
    "length",
    "split",
    "iStream",
    "createReadStream",
    "file",
    "getFilePath",
    "existsSync",
    "property",
    "value",
    "module",
    "exports"
  ],
  "mappings": "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",
  "file": "index.js",
  "sourceRoot": "../src",
  "sourcesContent": [
    "import Promise from \"bluebird\"\nimport gm from \"gm\"\nimport path from \"path\"\nimport fs from \"fs-extra\"\nimport props from \"./helper\"\n\nlet Private = props()\n\nclass PDF2IMG {\n    constructor(options) {\n        Private(this).quality = 100\n        Private(this).format = options.format || \"png\"\n        Private(this).size = options.size || 600\n        Private(this).density = options.density || 200\n        Private(this).savedir = options.savedir || undefined\n        Private(this).savename = options.savename || undefined\n        \n        /**\n         * GM command - identify\n         * @access private\n         * @param {String} file_path path to valid file\n         * @param {Mixed} argument gm identify argument\n         * @return {Promise} \n         */\n        Private(this).identify = (file_path, argument = undefined) => {\n            let image = gm(file_path)\n            \n            return new Promise((resolve, reject) => {\n                if(argument)\n                    image.identify(argument, (error, data) => {\n                        if(error)\n                            return reject(error)\n\n                        return resolve(data)\n                    })\n                else\n                    image.identify((error, data) => {\n                        if(error)\n                            return reject(error)\n\n                        return resolve(data)\n                    })  \n            })\n        }\n\n        /**\n         * GM command - write\n         * @access private\n         * @param {Stream} stream\n         * @param {String} output\n         * @param {String} filename\n         * @param {Integer} page\n         * @return {Promise} \n         */\n        Private(this).writeImage = (stream, output, filename, page) => {\n            return new Promise((resolve, reject) => {\n                gm(stream, filename)\n                    .density(Private(this).density, Private(this).density)\n                    .resize(Private(this).size)\n                    .quality(Private(this).quality)\n                    .write(output, (error) => {\n                        if(error)\n                            return reject(error)\n\n                        return resolve({\n                            name: path.basename(output),\n                            size: fs.statSync(output)['size'] / 1000.0,\n                            path: output,\n                            page\n                        })\n                  })\n            })\n        }\n\n    }\n\n    /**\n     * Intialize converter\n     * @param {String} pdf_path path to file\n     * @param {Page} page page number to be converted\n     * @return {Object} image status\n     */\n    async convert(pdf_path, page = 1) {\n        this.isValidPDF(pdf_path)\n        this.fileExists(pdf_path)\n\n        let output = path.basename(pdf_path, path.extname(path.basename(pdf_path)))\n\n        // Set output dir\n        if (this.get(\"savedir\"))\n            this.set(\"savedir\", this.get(\"savedir\") + path.sep)\n        else\n            this.set(\"savedir\", output + path.sep)\n        \n        fs.mkdirsSync(this.get(\"savedir\"))\n\n        if(!this.get(\"savename\"))\n            this.set(\"savename\", output)\n\n        let pages = await this.getPageCount(pdf_path)\n\n        if(page > pages)\n            throw {error: \"InvalidPageSelection\", message: \"Cannot convert non-existent page\"}\n        \n        return await this.toImage(pdf_path, page)\n    }\n\n    /**\n     * Intialize converter, well the bulk version\n     * @param {String} pdf_path path to file\n     * @param {Page} page page number to be converted (-1 for all pages)\n     * @return {Object} image status\n     */\n    async convertBulk(pdf_path, pages = -1) {\n        let result = []\n\n        pages = pages === -1 ? await this.getPage(pdf_path) : (Array.isArray(pages) ? pages : [1])\n\n        await Promise.each(pages, async function(each) {\n            result.push(await this.convert(pdf_path, each))\n        }.bind(this))\n        \n        return result\n    }\n\n    /**\n     * Get how many pages are there in the pdf file\n     * @param {String} pdf_path path to file\n     * @return {Integer} number of pages\n     */\n    async getPageCount(pdf_path) {\n        return await this.getPage(pdf_path).length\n    }\n\n    /**\n     * Get pages numbers\n     * @param {String} pdf_path path to file\n     * @return {Array} pages\n     */\n    async getPage(pdf_path) {\n        let page = await Private(this).identify(pdf_path, \"%p \")\n        page = page.split(\" \")\n        \n        return page\n    }\n\n    /**\n     * Converts pdf to image\n     * @param {String} pdf_path \n     * @param {Integer} page\n     * @return {Promise} \n     */\n    async toImage(pdf_path, page) {\n        let iStream  = fs.createReadStream(pdf_path)\n        let file     = `${this.get(\"savedir\")}${this.get(\"savename\")}_${page}.${this.get(\"format\")}`\n        let filename = `${this.getFilePath(iStream)}[${page - 1}]`\n\n        return await Private(this).writeImage(iStream, file, filename, page)\n    }\n\n    /**\n     * Get file path\n     * @param {Stream} stream\n     * @return {String} path\n     */\n    getFilePath(stream) {\n        if(!stream)\n            throw {error: \"InvalidPath\", message: \"Invalid Path\"}\n\n        return stream.path\n    }\n\n    /**\n     * Checks if the supplied file has the exact file format\n     * @param {String} pdf_path path to file\n     * @return {Mixed} file status\n     */\n    isValidPDF(pdf_path) {\n        if (path.extname(path.basename(pdf_path)) != '.pdf') \n            throw {error: \"InvalidPDF\", message: \"File supplied is not a valid PDF\"}\n        \n        return true\n    }\n\n    /**\n     * Checks if the supplied file has exists\n     * @param {String} pdf_path path to file\n     * @return {Mixed} file status\n     */\n    fileExists(pdf_path) {\n        if(!fs.existsSync(pdf_path))\n            throw {error: \"FileNotFound\", message: \"File supplied cannot be found\"}\n\n        return true\n    }\n\n    /**\n     * Get value from private property\n     * @param {String} property\n     * @return {Mixed} value of the property \n     */\n    get(property) {\n        return Private(this)[property]\n    }\n\n    /**\n     * Add/set value as private property\n     * @param {String} property \n     * @param {String} value\n     * @return {Object} this \n     */\n    set(property, value) {\n        Private(this)[property] = value\n\n        return this\n    }\n}\n\nmodule.exports = PDF2IMG"
  ]
}
